<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phantom Creators - 3D Printing Portal</title>
    <link rel="stylesheet" href="./css/styles.css">
    <meta name="description" content="Advanced 3D printing simulation and visualization platform">
    <script>
        // Error handler to diagnose loading issues
        window.addEventListener('error', function(e) {
            console.error('Script Error:', e.message, 'in', e.filename, 'line', e.lineno);
            const errorDiv = document.createElement('div');
            errorDiv.style.position = 'fixed';
            errorDiv.style.bottom = '10px';
            errorDiv.style.left = '10px';
            errorDiv.style.backgroundColor = 'rgba(255,0,0,0.8)';
            errorDiv.style.color = 'white';
            errorDiv.style.padding = '10px';
            errorDiv.style.borderRadius = '5px';
            errorDiv.style.zIndex = '9999';
            errorDiv.textContent = `Error: ${e.message} in ${e.filename.split('/').pop()} line ${e.lineno}`;
            document.body.appendChild(errorDiv);
        });
    </script>
</head>
<body>
    <header class="cyber-header">
        <div class="logo">Phantom Creators</div>
        <nav>
            <ul>
                <li><a href="#" class="glow-button">Home</a></li>
                <li><a href="#services" class="glow-button">Services</a></li>
                <li><a href="pages/products.html" class="glow-button">Products</a></li>
                <li><a href="#visualizer" class="glow-button">Visualizer</a></li>
                <li><a href="#contact" class="glow-button">Contact</a></li>
                <li class="user-actions">
                    <a href="pages/login.html" class="glow-button login-button">Login</a>
                    <a href="pages/register.html" class="glow-button register-button">Register</a>
                </li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="hero">
            <h1>Next-Gen 3D Printing <span class="highlight">Simulation</span></h1>
            <p>Visualize, analyze, and optimize your 3D models before printing</p>
            <div id="filament-stream" aria-label="Animated filament flow visualization" aria-hidden="true"></div>
        </section>

        <!-- 3D Printing Elements Section -->
        <section id="printing-tech">
            <h2>Cutting-Edge <span class="highlight">Printing Technology</span></h2>
            
            <div class="tech-showcase">
                <div class="tech-card">
                    <div class="tech-icon">
                        <svg viewBox="0 0 24 24" width="48" height="48">
                            <path fill="currentColor" d="M19 2c0-1.1-.9-2-2-2H7C5.9 0 5 .9 5 2v16l7 3 7-3V2zm-2 0v7h-2V2h2zm-6 15.82l-5-2.15V2h3v6h2V2h3v15.82l-3 1.23z"/>
                        </svg>
                    </div>
                    <h3>FDM Printing</h3>
                    <p>Layer-by-layer precision with a wide range of filament options for durability and flexibility</p>
                    <div class="tech-specs">
                        <span>0.1mm precision</span>
                        <span>7 material types</span>
                        <span>200x200x200mm build volume</span>
                    </div>
                </div>
                
                <div class="tech-card">
                    <div class="tech-icon">
                        <svg viewBox="0 0 24 24" width="48" height="48">
                            <path fill="currentColor" d="M21.1 9l-2.8-4c-.3-.4-.8-.7-1.3-.7H7c-.5 0-1 .3-1.3.7l-2.8 4c-.2.3-.3.6-.3 1 0 1.1.9 2 2 2h2v8h10v-8h2c1.1 0 2-.9 2-2 0-.4-.1-.7-.3-1zm-11.6 9v-8H5.9L8 6h8l2.1 4H11.5v8h-2z"/>
                        </svg>
                    </div>
                    <h3>SLA Resin Printing</h3>
                    <p>Ultra-high detail printing for miniatures, jewelry designs, and precision components</p>
                    <div class="tech-specs">
                        <span>0.025mm precision</span>
                        <span>5 resin types</span>
                        <span>120x120x150mm build volume</span>
                    </div>
                </div>
                
                <div class="tech-card">
                    <div class="tech-icon">
                        <svg viewBox="0 0 24 24" width="48" height="48">
                            <path fill="currentColor" d="M12 3L2 12h3v8h14v-8h3L12 3zm-3 13v-7h2v7H9zm4 0v-7h2v7h-2z"/>
                        </svg>
                    </div>
                    <h3>Multi-Material Printing</h3>
                    <p>Create complex models with multiple colors and materials in a single print job</p>
                    <div class="tech-specs">
                        <span>4 materials simultaneously</span>
                        <span>0.15mm precision</span>
                        <span>180x180x180mm build volume</span>
                    </div>
                </div>
            </div>

            <div class="printing-live-status">
                <h3>Live Printing Status</h3>
                <div class="status-grid">
                    <div class="status-card active">
                        <div class="status-indicator"></div>
                        <div class="status-details">
                            <h4>Printer 1 (FDM)</h4>
                            <p>Currently printing: Mechanical Parts</p>
                            <div class="progress-bar">
                                <div class="progress" style="width: 67%"></div>
                            </div>
                            <p class="status-meta">67% complete • 2h 15m remaining</p>
                        </div>
                    </div>
                    <div class="status-card active">
                        <div class="status-indicator"></div>
                        <div class="status-details">
                            <h4>Printer 2 (SLA)</h4>
                            <p>Currently printing: Jewelry Prototypes</p>
                            <div class="progress-bar">
                                <div class="progress" style="width: 23%"></div>
                            </div>
                            <p class="status-meta">23% complete • 5h 40m remaining</p>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-indicator idle"></div>
                        <div class="status-details">
                            <h4>Printer 3 (Multi-Material)</h4>
                            <p>Status: Ready</p>
                            <p class="status-meta">Available for next job</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="materials-showcase">
                <h3>Featured Materials</h3>
                <div class="material-cards">
                    <div class="material-card">
                        <div class="material-sample" style="background: linear-gradient(135deg, #00ff8c, #005c32)"></div>
                        <h4>Carbon Fiber PLA</h4>
                        <p>Ultra-strong, lightweight material for functional parts</p>
                    </div>
                    <div class="material-card">
                        <div class="material-sample" style="background: linear-gradient(135deg, #ff6b6b, #8c0000)"></div>
                        <h4>Flexible TPU</h4>
                        <p>Elastic properties for parts that need to bend and flex</p>
                    </div>
                    <div class="material-card">
                        <div class="material-sample" style="background: linear-gradient(135deg, #6b8cff, #00248c)"></div>
                        <h4>Clear PETG</h4>
                        <p>Transparent material with excellent durability</p>
                    </div>
                    <div class="material-card">
                        <div class="material-sample" style="background: linear-gradient(135deg, #c6c6c6, #3c3c3c)"></div>
                        <h4>Metal-Infused PLA</h4>
                        <p>Metallic finish with polishable properties</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="services">
            <h2>Our <span class="highlight">Services</span></h2>
            <div class="service-grid">
                <div class="service-card" role="region" aria-labelledby="service-title-1">
                    <h3 id="service-title-1">Complexity Analysis</h3>
                    <p>Advanced algorithm to determine optimal print settings</p>
                </div>
                <div class="service-card" role="region" aria-labelledby="service-title-2">
                    <h3 id="service-title-2">Material Simulation</h3>
                    <p>Visualize different materials before printing</p>
                </div>
                <div class="service-card" role="region" aria-labelledby="service-title-3">
                    <h3 id="service-title-3">Performance Prediction</h3>
                    <p>Estimate print time and resource usage</p>
                </div>
            </div>
        </section>

        <section id="visualizer">
            <h2>3D <span class="highlight">Visualizer</span></h2>
            
            <!-- Loading Indicator -->
            <div id="loading-container" class="loading-container hidden" aria-live="polite" aria-busy="true" style="display: none !important; opacity: 0 !important; visibility: hidden !important;">
                <div class="cyber-loading">
                    <div class="loading-spinner"></div>
                    <p id="loading-status">Processing...</p>
                    <div class="loading-progress">
                        <div id="loading-bar" class="loading-bar-fill" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            
            <div class="visualizer-container">
                <div id="3d-visualizer" class="model-container"></div>
                <div class="cyber-terminal" role="status" aria-live="polite">
                    <div class="terminal-content" id="terminal-output" aria-label="Order status updates"></div>
                </div>
            </div>
            
            <!-- Material Selection UI -->
            <div id="material-controls" class="control-panel">
                <h3>Material Selection</h3>
                <div class="material-options">
                    <div class="material-option">
                        <input type="radio" id="material-pla" name="material" value="pla" checked>
                        <label for="material-pla" class="material-label">PLA</label>
                    </div>
                    <div class="material-option">
                        <input type="radio" id="material-abs" name="material" value="abs">
                        <label for="material-abs" class="material-label">ABS</label>
                    </div>
                    <div class="material-option">
                        <input type="radio" id="material-petg" name="material" value="petg">
                        <label for="material-petg" class="material-label">PETG</label>
                    </div>
                    <div class="material-option">
                        <input type="radio" id="material-tpu" name="material" value="tpu">
                        <label for="material-tpu" class="material-label">TPU</label>
                    </div>
                </div>
                
                <h3>Material Properties</h3>
                <div class="property-sliders">
                    <div class="property-slider">
                        <label for="material-opacity">Opacity</label>
                        <input type="range" id="material-opacity" min="0" max="1" step="0.01" value="0.8">
                    </div>
                    <div class="property-slider">
                        <label for="material-metalness">Metalness</label>
                        <input type="range" id="material-metalness" min="0" max="1" step="0.01" value="0.2">
                    </div>
                    <div class="property-slider">
                        <label for="material-roughness">Roughness</label>
                        <input type="range" id="material-roughness" min="0" max="1" step="0.01" value="0.5">
                    </div>
                </div>
            </div>
            
            <!-- Print Control Panel -->
            <div id="print-controls" class="control-panel">
                <button id="analyze-btn" class="cyber-button">Analyze Model</button>
                <button id="slice-btn" class="cyber-button">Slice Model</button>
                <button id="start-print-btn" class="cyber-button">Start Print</button>
                <button id="pause-print-btn" class="cyber-button" disabled>Pause</button>
                <button id="resume-print-btn" class="cyber-button" disabled>Resume</button>
                <button id="cancel-print-btn" class="cyber-button" disabled>Cancel</button>
            </div>
            
            <!-- Slicer Control Panel (initially hidden) -->
            <div id="slicer-controls" class="control-panel hidden">
                <h3>Slicer Settings</h3>
                <div class="slicer-options">
                    <div class="slicer-option">
                        <label for="layer-height">Layer Height (mm)</label>
                        <select id="layer-height" class="cyber-select">
                            <option value="0.1">0.1 mm (High Quality)</option>
                            <option value="0.15">0.15 mm (Balanced)</option>
                            <option value="0.2" selected>0.2 mm (Standard)</option>
                            <option value="0.25">0.25 mm (Fast)</option>
                            <option value="0.3">0.3 mm (Draft)</option>
                        </select>
                    </div>
                    
                    <div class="slicer-option">
                        <label for="infill-density">Infill Density (%)</label>
                        <select id="infill-density" class="cyber-select">
                            <option value="10">10% (Light)</option>
                            <option value="20" selected>20% (Standard)</option>
                            <option value="30">30% (Strong)</option>
                            <option value="50">50% (Dense)</option>
                            <option value="100">100% (Solid)</option>
                        </select>
                    </div>
                    
                    <div class="slicer-option">
                        <label for="infill-pattern">Infill Pattern</label>
                        <select id="infill-pattern" class="cyber-select">
                            <option value="grid" selected>Grid</option>
                            <option value="triangles">Triangles</option>
                            <option value="zigzag">Zigzag</option>
                            <option value="concentric">Concentric</option>
                            <option value="gyroid">Gyroid</option>
                        </select>
                    </div>
                    
                    <div class="slicer-option">
                        <label for="print-speed">Print Speed (mm/s)</label>
                        <select id="print-speed" class="cyber-select">
                            <option value="30">30 mm/s (High Quality)</option>
                            <option value="50" selected>50 mm/s (Standard)</option>
                            <option value="80">80 mm/s (Fast)</option>
                            <option value="100">100 mm/s (Draft)</option>
                        </select>
                    </div>
                    
                    <div class="slicer-option">
                        <label for="support-type">Support Type</label>
                        <select id="support-type" class="cyber-select">
                            <option value="none" selected>None</option>
                            <option value="touching-buildplate">Touching Buildplate</option>
                            <option value="everywhere">Everywhere</option>
                        </select>
                    </div>
                    
                    <div class="slicer-option">
                        <label for="raft">Raft</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="raft" class="toggle-input">
                            <label for="raft" class="toggle-label"></label>
                        </div>
                    </div>
                    
                    <div class="slicer-option">
                        <label for="brim">Brim</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="brim" class="toggle-input">
                            <label for="brim" class="toggle-label"></label>
                        </div>
                    </div>
                </div>
                
                <div class="slicer-actions">
                    <button id="preview-slice-btn" class="cyber-button">Preview Slice</button>
                    <button id="generate-gcode-btn" class="cyber-button">Generate G-Code</button>
                    <button id="close-slicer-btn" class="cyber-button">Close</button>
                </div>
            </div>
            
            <!-- Slice Preview Panel (initially hidden) -->
            <div id="slice-preview" class="control-panel hidden">
                <h3>Slice Preview</h3>
                <div class="preview-container">
                    <div id="layer-preview" class="layer-preview-container"></div>
                    <div class="layer-controls">
                        <button id="prev-layer-btn" class="cyber-button" disabled>Previous Layer</button>
                        <span id="layer-counter">Layer: 0 / 0</span>
                        <button id="next-layer-btn" class="cyber-button" disabled>Next Layer</button>
                    </div>
                    <div class="slice-stats">
                        <div class="stat-item">
                            <span class="stat-label">Estimated Time:</span>
                            <span id="estimated-time" class="stat-value">0h 0m</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Material Used:</span>
                            <span id="material-used" class="stat-value">0 g</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Layer Count:</span>
                            <span id="layer-count" class="stat-value">0</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="upload-container">
                <label for="model-upload" class="glow-button">Upload STL File</label>
                <input type="file" id="model-upload" accept=".stl" aria-label="Upload 3D model file">
                <span class="or-separator">or</span>
                <button id="try-demo-btn" class="glow-button">Try Demo Models</button>
            </div>
        </section>

        <!-- Featured Prints Gallery Section -->
        <section id="featured-prints">
            <h2>Featured <span class="highlight">Projects</span></h2>
            <p class="section-intro">Explore our recent client projects and showcase prints</p>
            
            <div class="gallery-controls">
                <button class="gallery-nav prev" aria-label="Previous project">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                    </svg>
                </button>
                
                <div class="gallery-categories">
                    <button class="category-btn active" data-category="all">All Projects</button>
                    <button class="category-btn" data-category="mechanical">Mechanical</button>
                    <button class="category-btn" data-category="artistic">Artistic</button>
                    <button class="category-btn" data-category="prototype">Prototypes</button>
                </div>
                
                <button class="gallery-nav next" aria-label="Next project">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"/>
                    </svg>
                </button>
            </div>
            
            <div class="prints-gallery">
                <div class="gallery-item" data-category="mechanical">
                    <div class="gallery-image">
                        <img src="./img/print-mechanical-1.jpg" alt="Industrial robot arm prototype" 
                             onerror="this.src='https://via.placeholder.com/400x300/12121c/00ff8c?text=Robot+Arm+Prototype'">
                    </div>
                    <div class="gallery-info">
                        <h3>Robot Arm Prototype</h3>
                        <p class="gallery-desc">Multi-jointed mechanical arm with precision-engineered moving parts</p>
                        <div class="gallery-meta">
                            <span class="print-material"><span class="meta-label">Material:</span> Carbon Fiber PLA</span>
                            <span class="print-time"><span class="meta-label">Print Time:</span> 32 hours</span>
                        </div>
                        <a href="pages/products.html" class="cyber-button view-details-btn">View Details</a>
                    </div>
                </div>
                
                <div class="gallery-item" data-category="artistic">
                    <div class="gallery-image">
                        <img src="./img/print-artistic-1.jpg" alt="Cyberpunk cityscape model" 
                             onerror="this.src='https://via.placeholder.com/400x300/12121c/00ff8c?text=Cyberpunk+Cityscape'">
                    </div>
                    <div class="gallery-info">
                        <h3>Cyberpunk Cityscape</h3>
                        <p class="gallery-desc">Highly detailed urban landscape with over 200 unique buildings</p>
                        <div class="gallery-meta">
                            <span class="print-material"><span class="meta-label">Material:</span> Translucent PETG</span>
                            <span class="print-time"><span class="meta-label">Print Time:</span> 48 hours</span>
                        </div>
                        <a href="pages/products.html" class="cyber-button view-details-btn">View Details</a>
                    </div>
                </div>
                
                <div class="gallery-item" data-category="prototype">
                    <div class="gallery-image">
                        <img src="./img/print-prototype-1.jpg" alt="Drone body prototype" 
                             onerror="this.src='https://via.placeholder.com/400x300/12121c/00ff8c?text=Drone+Prototype'">
                    </div>
                    <div class="gallery-info">
                        <h3>Lightweight Drone Frame</h3>
                        <p class="gallery-desc">Aerodynamic drone body designed for maximum stability and minimal weight</p>
                        <div class="gallery-meta">
                            <span class="print-material"><span class="meta-label">Material:</span> Lightweight ABS</span>
                            <span class="print-time"><span class="meta-label">Print Time:</span> 26 hours</span>
                        </div>
                        <a href="pages/products.html" class="cyber-button view-details-btn">View Details</a>
                    </div>
                </div>
                
                <div class="gallery-item" data-category="mechanical">
                    <div class="gallery-image">
                        <img src="./img/print-mechanical-2.jpg" alt="Custom gearbox assembly" 
                             onerror="this.src='https://via.placeholder.com/400x300/12121c/00ff8c?text=Custom+Gearbox'">
                    </div>
                    <div class="gallery-info">
                        <h3>Custom Gearbox Assembly</h3>
                        <p class="gallery-desc">Precision interlocking gears with 0.2mm tolerance for smooth operation</p>
                        <div class="gallery-meta">
                            <span class="print-material"><span class="meta-label">Material:</span> Metal-infused PLA</span>
                            <span class="print-time"><span class="meta-label">Print Time:</span> 18 hours</span>
                        </div>
                        <a href="pages/products.html" class="cyber-button view-details-btn">View Details</a>
                    </div>
                </div>
            </div>
            
            <div class="gallery-pagination">
                <span class="page-dot active"></span>
                <span class="page-dot"></span>
                <span class="page-dot"></span>
                <span class="page-dot"></span>
            </div>
            
            <div class="cta-container">
                <p>Want to see your project here? We're ready to bring your ideas to life.</p>
                <a href="pages/products.html" class="glow-button">Start Your Print</a>
            </div>
        </section>

        <section id="contact">
            <h2>Contact <span class="highlight">Us</span></h2>
            <form id="contact-form">
                <div class="form-group">
                    <label for="name">Name</label>
                    <input type="text" id="name" required>
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="message">Message</label>
                    <textarea id="message" required></textarea>
                </div>
                <button type="submit" class="glow-button">Send Message</button>
            </form>
        </section>
    </main>

    <footer>
        <p>&copy; 2023 Phantom Creators. All rights reserved.</p>
    </footer>

    <!-- Hidden Documentation Panel -->
    <div id="cyber-docs" class="hidden">
        <div class="docs-header">
            <h3>Documentation</h3>
            <button class="close-docs">×</button>
        </div>
        <div id="docs-content"></div>
    </div>
    
    <!-- Performance Stats Panel -->
    <div id="performance-stats" class="performance-monitor hidden">
        <div class="stats-header">
            <h4>Performance Metrics</h4>
            <button class="close-stats">×</button>
        </div>
        <div id="stats-content">
            <div class="stat-row">
                <span>FPS:</span>
                <span id="stat-fps">0</span>
            </div>
            <div class="stat-row">
                <span>Memory:</span>
                <span id="stat-memory">0 MB</span>
            </div>
            <div class="stat-row">
                <span>Render Time:</span>
                <span id="stat-render">0 ms</span>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/STLLoader.js"></script>
    <script src="./js/filament-stream.js"></script>
    <script src="./js/complexity-analyzer.js"></script>
    <script src="./js/material-visualizer.js"></script>
    <script src="./js/print-state-manager.js"></script>
    <script src="./js/docs.js"></script>
    <script src="./js/main.js"></script>
    <script src="./js/demo.js"></script>
    <script src="./js/cart.js"></script>
    
    <!-- Force initialization of the visualizer -->
    <script>
        // Ensure THREE.js is loaded or load it
        if (!window.THREE) {
            console.warn("THREE.js not detected, loading fallback");
            const threeScript = document.createElement('script');
            threeScript.src = "https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js";
            threeScript.onload = function() {
                const loaderScript = document.createElement('script');
                loaderScript.src = "https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/STLLoader.js";
                document.head.appendChild(loaderScript);
            };
            document.head.appendChild(threeScript);
        }
        
        // Initialize visualizer as soon as possible
        window.addEventListener('load', function() {
            // Force loading to be hidden
            const loadingContainer = document.getElementById('loading-container');
            if (loadingContainer) {
                loadingContainer.classList.add('hidden');
                loadingContainer.style.display = 'none';
            }
            
            // Direct initialization of visualizer if not already initialized
            if (!window.materialVisualizer) {
                const modelContainer = document.getElementById('3d-visualizer');
                if (modelContainer) {
                    try {
                        console.log("Directly initializing visualizer");
                        const visualizer = new OptimizedMaterialVisualizer(modelContainer);
                        window.materialVisualizer = visualizer;
                        
                        // Update terminal
                        const terminal = document.getElementById('terminal-output');
                        if (terminal) {
                            terminal.innerHTML = '> System ready. Visualizer initialized.<br>> Upload a model or try the demo.';
                        }
                    } catch (e) {
                        console.error("Error initializing visualizer:", e);
                    }
                }
            }
        });
    </script>
    
    <!-- Initialize the application -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Immediately hide the loading container
            var loadingContainer = document.getElementById('loading-container');
            if (loadingContainer) {
                loadingContainer.classList.add('hidden');
                // Also set display none to ensure it's hidden
                loadingContainer.style.display = 'none';
            }
            
            // Create global fallback if structure doesn't exist
            if (!window.PhantomCreators) {
                console.warn('PhantomCreators global object not found, creating fallback');
                window.PhantomCreators = {
                    config: {
                        debug: true,
                        autoStartAnimation: true
                    },
                    components: {},
                    init: function() {
                        console.log('Initializing with fallback structure');
                    }
                };
            }
            
            // Initialize the main application
            try {
                if (typeof PhantomCreators.init === 'function') {
                    PhantomCreators.init();
                }
            } catch (error) {
                console.error('Error initializing main application:', error);
            }
            
            // Add terminal status message
            const terminal = document.getElementById('terminal-output');
            if (terminal) {
                terminal.textContent = '> Ready to analyze models. Try the demo mode or upload an STL file.';
            }
            
            // Additional backup to ensure loading is hidden
            setTimeout(function() {
                var loadingContainer = document.getElementById('loading-container');
                if (loadingContainer) {
                    loadingContainer.classList.add('hidden');
                    loadingContainer.style.display = 'none';
                }
                
                // If demo mode exists, make sure it's initialized
                if (window.PhantomCreatorsDemo && typeof window.PhantomCreatorsDemo.init === 'function') {
                    // Check if already initialized
                    if (!window.PhantomCreatorsDemo.initialized) {
                        window.PhantomCreatorsDemo.init();
                        window.PhantomCreatorsDemo.initialized = true;
                    }
                }
                
                // Show success message
                const successMsg = document.createElement('div');
                successMsg.style.position = 'fixed';
                successMsg.style.bottom = '20px';
                successMsg.style.right = '20px';
                successMsg.style.backgroundColor = 'rgba(0, 255, 140, 0.9)';
                successMsg.style.color = '#000';
                successMsg.style.padding = '12px 20px';
                successMsg.style.borderRadius = '5px';
                successMsg.style.zIndex = '9999';
                successMsg.style.boxShadow = '0 0 15px rgba(0, 255, 140, 0.5)';
                successMsg.style.fontWeight = 'bold';
                successMsg.textContent = '✓ Material visualizer fixed and optimized';
                document.body.appendChild(successMsg);
                
                // Remove success message after 5 seconds
                setTimeout(function() {
                    successMsg.style.transition = 'opacity 1s ease-out';
                    successMsg.style.opacity = '0';
                    setTimeout(function() {
                        if (successMsg.parentNode) {
                            successMsg.parentNode.removeChild(successMsg);
                        }
                    }, 1000);
                }, 5000);
            }, 2000);
        });
    </script>
</body>
</html> 